var TrimPath;
(function(){if(TrimPath==null)TrimPath={};if(TrimPath.evalEx==null)TrimPath.evalEx=function(a){return eval(a)};if(Array.prototype.pop==null)Array.prototype.pop=function(){if(this.length!==0)return this[--this.length]};if(Array.prototype.push==null)Array.prototype.push=function(){for(var a=0;a<arguments.length;++a)this[this.length]=arguments[a];return this.length};TrimPath.parseTemplate=function(a,c,d){if(d==null)d=TrimPath.parseTemplate_etc;var j,b=a;j=d;b=b;b=b.replace(/\t/g,"    ");b=b.replace(/\r\n/g,
"\n");b=b.replace(/\r/g,"\n");b=b=b.replace(/^(\s*\S*(\s+\S+)*)\s*$/,"$1");for(var k=["var TrimPath_Template_TEMP = function(_OUT, _CONTEXT, _FLAGS) { with (_CONTEXT) {"],n={stack:[],line:1},e=-1;e+1<b.length;){var h=e;for(h=b.indexOf("{",h+1);h>=0;){var g=b.indexOf("}",h+1);if(g=b.substring(h,g).match(/^\{(cdata|minify|eval)/)){g=g[1];var l=h+g.length+1,o=b.indexOf("}",l);if(o>=0){l=o-l<=0?"{/"+g+"}":b.substring(l+1,o);var p=b.indexOf(l,o+1);if(p>=0){s(b.substring(e+1,h),k);e=b.substring(o+1,p);
if(g=="cdata")t(e,k);else if(g=="minify"){g=e;g=g.replace(/^\s+/g,"");g=g.replace(/\s+$/g,"");g=g.replace(/\s+/g," ");g=g.replace(/^(\s*\S*(\s+\S+)*)\s*$/,"$1");t(g,k)}else g=="eval"&&e!=null&&e.length>0&&k.push("_OUT.write( (function() { "+e+" })() );");h=e=p+l.length-1}}}else if(b.charAt(h-1)!="$"&&b.charAt(h-1)!="\\"){g=b.charAt(h+1)=="/"?2:1;if(b.substring(h+g,h+10+g).search(TrimPath.parseTemplate_etc.statementTag)==0)break}h=b.indexOf("{",h+1)}if(h<0)break;g=b.indexOf("}",h+1);if(g<0)break;s(b.substring(e+
1,h),k);p=b.substring(h,g+1);o=n;e=k;var m=c,u=j;h=p.slice(1,-1).split(" ");l=u.statementDef[h[0]];if(l==null)s(p,e);else{if(l.delta<0){if(o.stack.length<=0)throw new u.ParseError(m,o.line,"close tag does not match any previous statement: "+p);o.stack.pop()}l.delta>0&&o.stack.push(p);if(l.paramMin!=null&&l.paramMin>=h.length)throw new u.ParseError(m,o.line,"statement needs more parameters: "+p);l.prefixFunc!=null?e.push(l.prefixFunc(h,o,m,u)):e.push(l.prefix);if(l.suffix!=null){if(h.length<=1)l.paramDefault!=
null&&e.push(l.paramDefault);else for(p=1;p<h.length;p++){p>1&&e.push(" ");e.push(h[p])}e.push(l.suffix)}}e=g}s(b.substring(e+1),k);if(n.stack.length!=0)throw new j.ParseError(c,n.line,"unclosed, unmatched statement(s): "+n.stack.join(","));k.push("}}; TrimPath_Template_TEMP");j=k.join("");b=TrimPath.evalEx(j,c,1);if(b!=null)return new d.Template(c,a,j,b,d);return null};try{String.prototype.process=function(a,c){var d=TrimPath.parseTemplate(this,null);if(d!=null)return d.process(a,c);return this}}catch(f){}TrimPath.parseTemplate_etc=
{};TrimPath.parseTemplate_etc.statementTag="forelse|for|if|elseif|else|var|macro";TrimPath.parseTemplate_etc.statementDef={"if":{delta:1,prefix:"if (",suffix:") {",paramMin:1},"else":{delta:0,prefix:"} else {"},elseif:{delta:0,prefix:"} else if (",suffix:") {",paramDefault:"true"},"/if":{delta:-1,prefix:"}"},"for":{delta:1,paramMin:3,prefixFunc:function(a,c,d,j){if(a[2]!="in")throw new j.ParseError(d,c.line,"bad for loop statement: "+a.join(" "));c=a[1];d="__LIST__"+c;return["var ",d," = ",a[3],";var __LENGTH_STACK__;if (typeof(__LENGTH_STACK__) == 'undefined' || !__LENGTH_STACK__.length) __LENGTH_STACK__ = new Array();__LENGTH_STACK__[__LENGTH_STACK__.length] = 0;if ((",
d,") != null) { var ",c,"_ct = 0;for (var ",c,"_index in ",d,") { ",c,"_ct++;if (typeof(",d,"[",c,"_index]) == 'function') {continue;}__LENGTH_STACK__[__LENGTH_STACK__.length - 1]++;var ",c," = ",d,"[",c,"_index];"].join("")}},forelse:{delta:0,prefix:"} } if (__LENGTH_STACK__[__LENGTH_STACK__.length - 1] == 0) { if (",suffix:") {",paramDefault:"true"},"/for":{delta:-1,prefix:"} }; delete __LENGTH_STACK__[__LENGTH_STACK__.length - 1];"},"var":{delta:0,prefix:"var ",suffix:";"},macro:{delta:1,prefixFunc:function(a){var c=
a[1].split("(")[0];return["var ",c," = function",a.slice(1).join(" ").substring(c.length),"{ var _OUT_arr = []; var _OUT = { write: function(m) { if (m) _OUT_arr.push(m); } }; "].join("")}},"/macro":{delta:-1,prefix:" return _OUT_arr.join(''); };"}};TrimPath.parseTemplate_etc.modifierDef={eat:function(){return""},escape:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},capitalize:function(a){return String(a).toUpperCase()},"default":function(a,c){return a!=
null?a:c}};TrimPath.parseTemplate_etc.modifierDef.h=TrimPath.parseTemplate_etc.modifierDef.escape;TrimPath.parseTemplate_etc.Template=function(a,c,d,j,b){this.process=function(k,n){if(k==null)k={};if(k._MODIFIERS==null)k._MODIFIERS={};if(k.defined==null)k.defined=function(l){return k[l]!=undefined};for(var e in b.modifierDef)if(k._MODIFIERS[e]==null)k._MODIFIERS[e]=b.modifierDef[e];if(n==null)n={};var h=[];e={write:function(l){h.push(l)}};try{j(e,k,n)}catch(g){if(n.throwExceptions==true)throw g;e=
new String(h.join("")+"[ERROR: "+g.toString()+(g.message?"; "+g.message:"")+"]");e.exception=g;return e}return h.join("")};this.name=a;this.source=c;this.sourceFunc=d;this.toString=function(){return"TrimPath.Template ["+a+"]"}};TrimPath.parseTemplate_etc.ParseError=function(a,c,d){this.name=a;this.line=c;this.message=d};TrimPath.parseTemplate_etc.ParseError.prototype.toString=function(){return"TrimPath template ParseError in "+this.name+": line "+this.line+", "+this.message};var s=function(a,c){if(!(a.length<=
0)){for(var d=0,j=a.length-1;d<a.length&&a.charAt(d)=="\n";)d++;for(;j>=0&&(a.charAt(j)==" "||a.charAt(j)=="\t");)j--;if(j<d)j=d;if(d>0){c.push('if (_FLAGS.keepWhitespace == true) _OUT.write("');var b=a.substring(0,d).replace("\n","\\n");if(b.charAt(b.length-1)=="\n")b=b.substring(0,b.length-1);c.push(b);c.push('");')}d=a.substring(d,j+1).split("\n");for(b=0;b<d.length;b++){for(var k=d[b],n=c,e="}",h=-1;h+e.length<k.length;){var g="${",l="}",o=k.indexOf(g,h+e.length);if(o<0)break;if(k.charAt(o+2)==
"%"){g="${%";l="%}"}var p=k.indexOf(l,o+g.length);if(p<0)break;t(k.substring(h+e.length,o),n);e=k.substring(o+g.length,p).replace(/\|\|/g,"#@@#").split("|");for(var m in e)if(e[m].replace)e[m]=e[m].replace(/#@@#/g,"||");n.push("_OUT.write(");q(e,e.length-1,n);n.push(");");h=p;e=l}t(k.substring(h+e.length),n);b<d.length-1&&c.push('_OUT.write("\\n");\n')}if(j+1<a.length){c.push('if (_FLAGS.keepWhitespace == true) _OUT.write("');b=a.substring(j+1).replace("\n","\\n");if(b.charAt(b.length-1)=="\n")b=
b.substring(0,b.length-1);c.push(b);c.push('");')}}},t=function(a,c){if(!(a==null||a.length<=0)){a=a.replace(/\\/g,"\\\\");a=a.replace(/\n/g,"\\n");a=a.replace(/"/g,'\\"');c.push('_OUT.write("');c.push(a);c.push('");')}},q=function(a,c,d){var j=a[c];if(c<=0)d.push(j);else{j=j.split(":");d.push('_MODIFIERS["');d.push(j[0]);d.push('"](');q(a,c-1,d);if(j.length>1){d.push(",");d.push(j[1])}d.push(")")}};TrimPath.parseDOMTemplate=function(a,c,d){if(c==null)c=document;c=c.getElementById(a);var j=c.value;
if(j==null)j=c.innerHTML;j=j.replace(/&lt;/g,"<").replace(/&gt;/g,">");return TrimPath.parseTemplate(j,a,d)};TrimPath.processDOMTemplate=function(a,c,d,j,b){return TrimPath.parseDOMTemplate(a,j,b).process(c,d)}})();function ltrim(f){return f.replace(/\s*((\S+\s*)*)/,"$1")}function rtrim(f){return f.replace(/((\s*\S+)*)\s*/,"$1")}function trim(f){return ltrim(rtrim(f))}var outputfield="#samplecode";function NormalizeSpace(f){if(f){f=f.replace(/^\s*|\s*$/g,"");return f.replace(/\s+/g," ")}}
function filter(f,s){r=[];if(f==null)for(i in s)s[i]&&r.push(s[i]);else for(i in s)f(s[i])&&r.push(s[i]);return r}
function codeit(){var f=NormalizeSpace($("#givenname").val()),s=NormalizeSpace($("#additionalname").val()),t=NormalizeSpace($("#familyname").val()),q=$("#url").val(),a=$("#aim").val(),c=$("#yim").val(),d=$("#jabber").val(),j=$("#vorg").val(),b=$("#email").val(),k=$("#street").val(),n=$("#city").val(),e=$("#region").val(),h=$("#postal").val(),g=$("#country").val(),l=$("#phone").val(),o=$("#photo").val(),p=$("#tags").val(),m={vcard:'<div id="${id}" class="vcard">${content}</div>',given_name:'  <span class="given-name">${given_name}</span>',
additional_name:'  <span class="additional-name">${additional_name}</span>',family_name:'  <span class="family-name">${family_name}</span>',photo:'  <img style="float:left; margin-right:4px" src="${photo_url}" alt="photo of ${fn}" class="photo"/>',org:' <div class="org">${org}</div>',email:' <a class="email" href="mailto:${email}">${email}</a>',street_address:'  <div class="street-address">${street_address}</div>',city:'  <span class="locality">${city}</span>',region:'  <span class="region">${region}</span>',
postal_code:'  <span class="postal-code">${postal_code}</span>',country_name:'  <span class="country-name">${country}</span>',tel:' <div class="tel">${tel}</div>',aim:' <a class="url" href="aim:goim?screenname=${aim}">AIM</a>\n',yim:' <a class="url" href="ymsgr:sendIM?${yim}">YIM</a>\n',jabber:' <a class="url" href="xmpp:${jabber}">Jabber</a>\n',tags:'<div class="tags">${tags}</div>',tag:'<a href="${url}">${term}</a>',ad:'<p>This <a href="http://microformats.org/wiki/hcard">hCard</a> created with the <a href="https://davidturner.name/hcard/">hCard creator</a>.</p>'},
u=(s==undefined||s=="")&&f&&f.indexOf(" ")==-1&&t&&t.indexOf(" ")==-1;if(u)var v=filter(null,[f,t]).join(" ");else{v=m.given_name.process({given_name:f})+"\n";var x=f;if(s!="")v+=m.additional_name.process({additional_name:s})+"\n";v+=m.family_name.process({family_name:t})+"\n"}f=filter(null,[f,s,t]).length>0?filter(null,["hcard",f,s,t]).join(" ").replace(/ /g,"-"):"";f=f.replace("-function-(a){for(var-b=0;b<this.length;b++)if(this[b]==a)return-b;return-1}","");f='<div id="'+f+'" class="vcard">\n';
if(o&&o.match(/http:\/\/.*\..{2,4}.*\/.+/))f+=m.photo.process({photo_url:o,fn:x})+"\n";if(q&&q.match(/http\:\/\/.*\..{2,4}.*/)){f+=' <a class="url fn';u||(f+=" n");f+='" href="'+q+'">'+v+"</a>\n"}else{f+=' <span class="'+(u?"fn":"fn n")+'">';f+=(u?"":"\n  ")+v+"</span>\n"}if(j)f+=m.org.process({org:j})+"\n";if(b)f+=m.email.process({email:b})+"\n";if(k||n||e||h||g){f+=' <div class="adr">\n';if(k)f+=m.street_address.process({street_address:k})+"\n";q="";if(n)q+=m.city.process({city:n})+"\n";if(e){if(q)q+=
", \n";q+=m.region.process({region:e})+"\n"}if(h){if(q)q+=", \n";q+=m.postal_code.process({postal_code:h})+"\n"}if(g){if(q)q+="\n";q+=m.country_name.process({country:g})+"\n"}if(q)q+="\n";f+=q+" </div>\n"}if(l)f+=m.tel.process({tel:l})+"\n";if(a)f+=m.aim.process({aim:a})+"\n";if(c)f+=m.yim.process({yim:c})+"\n";if(d)f+=m.jabber.process({jabber:d})+"\n";if(p){n=p.split(",");e="";for(var w in n)e+=m.tag.process({term:trim(n[w]),url:"http://kitchen.technorati.com/contacts/tag/"+trim(n[w])})+" ";f+=m.tags.process({tags:e})}f+=
m.ad.process({})+"\n";f+="</div>";$(outputfield).val(f);$("#preview").html(f);b||l||c||a||d?$("#warning").css("display","inline"):$("#warning").css("display","none")}function doinit(){$("input").keyup(window.codeit);$("input").click(window.codeit);doreset()}function doreset(){codeit()}$(window.doinit);$("#hCard-generator").bind("click",function(){codeit();return false});